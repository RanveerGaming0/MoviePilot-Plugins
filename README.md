# P115StrgmSub - 115网盘订阅追更插件

MoviePilot 插件，自动将订阅的电影和电视剧从 115 网盘分享链接转存到个人网盘。

## 完整工作流

本插件配合 [115网盘STRM助手](https://github.com/DDSRem-Dev/MoviePilot-Plugins) 可实现完整的自动化追剧流程：

```
MoviePilot订阅 -> 本插件搜索转存 -> STRM助手生成STRM -> 媒体库刮削 -> 播放器观看
```

## 功能特点

- **支持电影和电视剧**订阅自动追更
- **双搜索源**：PanSou（网盘搜索）+ Nullbr（TMDB ID 精准匹配）
- **智能匹配**：支持 S01E01、第X集、EP01 等多种命名格式
- **洗版模式**：自动升级更高质量资源（基于订阅的质量/分辨率/特效设置）
- **订阅过滤**：继承 MoviePilot 订阅的质量、分辨率、特效过滤条件
- **屏蔽系统订阅**：可阻止 MoviePilot 默认的订阅下载，仅使用本插件转存
- **避免重复**：自动检查网盘已有文件和历史记录
- **自动完成订阅**：转存完成后自动标记订阅完成

## 依赖

```bash
pip install p115client>=0.0.8.2 sqlitetools>=0.0.7
```

## 配置说明

### 基础配置

| 配置项 | 说明 |
|--------|------|
| 启用插件 | 开启/关闭插件 |
| 发送通知 | 转存完成后发送消息通知 |
| 执行周期 | cron表达式，默认每小时30分执行 |
| 电视剧转存目录 | 默认 `/我的接收/MoviePilot/TV` |
| 电影转存目录 | 默认 `/我的接收/MoviePilot/Movie` |

### 115 网盘配置

填入 115 Cookie（可从115网盘STRM助手复制）

### 搜索源配置

**PanSou**（网盘搜索服务）:
- API 地址、用户名/密码（可选认证）
- TG 搜索频道（可选），为空的话将搜索PanSou默认频道

**Nullbr**（TMDB精准匹配）:
- APP ID 和 API Key
- 可设置优先使用 Nullbr 或 PanSou

### 高级配置

| 配置项 | 说明 |
|--------|------|
| 只搜索115资源 | PanSou 搜索时只返回115网盘资源 |
| 屏蔽系统订阅 | 阻止 MoviePilot 默认订阅处理 |
| 排除订阅 | 指定不处理的订阅ID |

## 转存路径结构

```
电视剧: {电视剧目录}/{剧名}/Season {季号}/
电影:   {电影目录}/{片名} ({年份})/
```

## 使用方法

1. 在 MoviePilot 插件管理中安装本插件
2. 配置 115 Cookie
3. 配置至少一个搜索源（PanSou 或 Nullbr）
4. 在 MoviePilot 中添加订阅
5. 启用插件，等待定时任务执行或者手动执行一次

## 注意事项

- 115 Cookie 有效期有限，失效后需重新获取
- 搜索结果取决于资源库收录情况
- 洗版模式需要在订阅中开启"洗版"选项
